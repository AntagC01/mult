<!DOCTYPE html>
<html>
<head>
    <title>Multiplayer Test</title>
    <style>
        canvas { background: #222; display: block; margin: auto; }
    </style>
</head>
<body>

<button id="sendMsg">Enviar Mensagem</button>
<canvas id="game" width="800" height="800"></canvas>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();

const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let players = {};

socket.on("currentPlayers", p => players = p);

socket.on("newPlayer", player => {
    players[player.id] = { x: player.x, y: player.y };
});

socket.on("playerDisconnected", id => {
    delete players[id];
});

// === NOVO: Receber mensagem global ===
socket.on("broadcastMessage", msg => {
    alert("üì¢ Mensagem global: " + msg);
});

// === NOVO: Bot√£o para enviar mensagem ===
document.getElementById("sendMsg").addEventListener("click", () => {
    socket.emit("broadcastMessage", "Ol√° jogadores!");
});

function gameLoop() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    for (let id in players) {
        const p = players[id];
        ctx.fillStyle = id === socket.id ? "yellow" : "white";
        ctx.fillRect(p.x, p.y, 20, 20);
    }

    requestAnimationFrame(gameLoop);
}

gameLoop();
</script>

</body>
</html>
